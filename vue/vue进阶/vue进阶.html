<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue进阶-day01 | 笔记栈</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/assets/img/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.0d7c1303.js" as="script"><link rel="preload" href="/assets/js/2.1fe0b50b.js" as="script"><link rel="preload" href="/assets/js/70.5ff6d4e4.js" as="script"><link rel="prefetch" href="/assets/js/10.2978dd1f.js"><link rel="prefetch" href="/assets/js/11.0dbaa531.js"><link rel="prefetch" href="/assets/js/12.32c02705.js"><link rel="prefetch" href="/assets/js/13.109a51a8.js"><link rel="prefetch" href="/assets/js/14.515ca27a.js"><link rel="prefetch" href="/assets/js/15.5ded3296.js"><link rel="prefetch" href="/assets/js/16.8bc52c4e.js"><link rel="prefetch" href="/assets/js/17.68df63de.js"><link rel="prefetch" href="/assets/js/18.89b1b877.js"><link rel="prefetch" href="/assets/js/19.901364af.js"><link rel="prefetch" href="/assets/js/20.5481b80d.js"><link rel="prefetch" href="/assets/js/21.2a144945.js"><link rel="prefetch" href="/assets/js/22.70831219.js"><link rel="prefetch" href="/assets/js/23.3b0c302e.js"><link rel="prefetch" href="/assets/js/24.878e1e96.js"><link rel="prefetch" href="/assets/js/25.9ff49721.js"><link rel="prefetch" href="/assets/js/26.093c8bdc.js"><link rel="prefetch" href="/assets/js/27.401b5c78.js"><link rel="prefetch" href="/assets/js/28.dc1c7c43.js"><link rel="prefetch" href="/assets/js/29.40e51e71.js"><link rel="prefetch" href="/assets/js/3.ac9d9143.js"><link rel="prefetch" href="/assets/js/30.b76a99b4.js"><link rel="prefetch" href="/assets/js/31.c3ef67ce.js"><link rel="prefetch" href="/assets/js/32.6c5637f7.js"><link rel="prefetch" href="/assets/js/33.a43732df.js"><link rel="prefetch" href="/assets/js/34.944b27fe.js"><link rel="prefetch" href="/assets/js/35.c2719e80.js"><link rel="prefetch" href="/assets/js/36.db5072a0.js"><link rel="prefetch" href="/assets/js/37.3aac3f33.js"><link rel="prefetch" href="/assets/js/38.ac02531c.js"><link rel="prefetch" href="/assets/js/39.b9d37857.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/40.750e94fc.js"><link rel="prefetch" href="/assets/js/41.941fe774.js"><link rel="prefetch" href="/assets/js/42.bcdffcaa.js"><link rel="prefetch" href="/assets/js/43.1188d721.js"><link rel="prefetch" href="/assets/js/44.0ba6bb4b.js"><link rel="prefetch" href="/assets/js/45.a98c08d8.js"><link rel="prefetch" href="/assets/js/46.1339ab8c.js"><link rel="prefetch" href="/assets/js/47.1e9f1793.js"><link rel="prefetch" href="/assets/js/48.0b65993c.js"><link rel="prefetch" href="/assets/js/49.98d284b0.js"><link rel="prefetch" href="/assets/js/5.f3e6ed41.js"><link rel="prefetch" href="/assets/js/50.40c11909.js"><link rel="prefetch" href="/assets/js/51.401f93f0.js"><link rel="prefetch" href="/assets/js/52.b0168dbe.js"><link rel="prefetch" href="/assets/js/53.8b60059b.js"><link rel="prefetch" href="/assets/js/54.161c06e4.js"><link rel="prefetch" href="/assets/js/55.afd26206.js"><link rel="prefetch" href="/assets/js/56.55d94850.js"><link rel="prefetch" href="/assets/js/57.ae35ff7c.js"><link rel="prefetch" href="/assets/js/58.96b6abba.js"><link rel="prefetch" href="/assets/js/59.91f247f9.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/60.2b43d161.js"><link rel="prefetch" href="/assets/js/61.9ebe816a.js"><link rel="prefetch" href="/assets/js/62.bc73408a.js"><link rel="prefetch" href="/assets/js/63.f8745496.js"><link rel="prefetch" href="/assets/js/64.4ae7ce85.js"><link rel="prefetch" href="/assets/js/65.23ecc3e4.js"><link rel="prefetch" href="/assets/js/66.1d24d480.js"><link rel="prefetch" href="/assets/js/67.6042bfed.js"><link rel="prefetch" href="/assets/js/68.ed1e1ed8.js"><link rel="prefetch" href="/assets/js/69.28d1024d.js"><link rel="prefetch" href="/assets/js/7.3f5168c2.js"><link rel="prefetch" href="/assets/js/71.bd57315c.js"><link rel="prefetch" href="/assets/js/72.e93c0d6e.js"><link rel="prefetch" href="/assets/js/73.4229454d.js"><link rel="prefetch" href="/assets/js/74.c2eb2bad.js"><link rel="prefetch" href="/assets/js/75.7eca9a4e.js"><link rel="prefetch" href="/assets/js/76.b83f903e.js"><link rel="prefetch" href="/assets/js/77.b9a22162.js"><link rel="prefetch" href="/assets/js/78.2450176d.js"><link rel="prefetch" href="/assets/js/79.ff4267c4.js"><link rel="prefetch" href="/assets/js/8.0e4354f9.js"><link rel="prefetch" href="/assets/js/80.abebe711.js"><link rel="prefetch" href="/assets/js/81.d8369dc4.js"><link rel="prefetch" href="/assets/js/82.5da13948.js"><link rel="prefetch" href="/assets/js/83.deb172fd.js"><link rel="prefetch" href="/assets/js/84.727650ec.js"><link rel="prefetch" href="/assets/js/85.50b1b4ef.js"><link rel="prefetch" href="/assets/js/86.90bb267e.js"><link rel="prefetch" href="/assets/js/9.de4e9e4c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="笔记栈" class="logo"> <span class="site-name can-hide">笔记栈</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          html
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端基础/第一天html笔记/" class="nav-link">
  html-one
</a></li><li class="dropdown-subitem"><a href="/前端基础/第二天html总结/" class="nav-link">
  html-two
</a></li></ul></li><li class="dropdown-item"><h4>
          css
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端基础/css第一天/" class="nav-link">
  css-one
</a></li><li class="dropdown-subitem"><a href="/前端基础/css第二天/" class="nav-link">
  css-two
</a></li><li class="dropdown-subitem"><a href="/前端基础/css第三天/" class="nav-link">
  css-twree
</a></li><li class="dropdown-subitem"><a href="/前端基础/css第四天/" class="nav-link">
  css-four
</a></li><li class="dropdown-subitem"><a href="/前端基础/笔记-day07-前端基础CSS第五天/" class="nav-link">
  css-five
</a></li><li class="dropdown-subitem"><a href="/前端基础/笔记-day08-前端基础CSS第六天/" class="nav-link">
  css-six
</a></li><li class="dropdown-subitem"><a href="/前端基础/笔记-day09-前端基础CSS第七天/" class="nav-link">
  css-seven
</a></li><li class="dropdown-subitem"><a href="/前端基础/day10-HTML5&amp;CSS3提高/" class="nav-link">
  css html提高
</a></li><li class="dropdown-subitem"><a href="/前端基础/移动端/" class="nav-link">
  移动端
</a></li><li class="dropdown-subitem"><a href="/前端基础/day01/" class="nav-link">
  移动端布局
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/basis/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/js/senior/" class="nav-link">
  JavaScript高级
</a></li><li class="dropdown-item"><!----> <a href="/webapi/webapinew/" class="nav-link">
  webapi新
</a></li><li class="dropdown-item"><!----> <a href="/webapi/pk webapi/" class="nav-link">
  webapi
</a></li><li class="dropdown-item"><!----> <a href="/js/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/js/跨域防抖节流 Promise/" class="nav-link">
  跨域防抖节流
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="git&amp;ajax&amp;JQ" class="dropdown-title"><span class="title">git&amp;ajax&amp;JQ</span> <span class="arrow down"></span></button> <button type="button" aria-label="git&amp;ajax&amp;JQ" class="mobile-dropdown-title"><span class="title">git&amp;ajax&amp;JQ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/git/Git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/ajax/Ajax/" class="nav-link">
  ajax
</a></li><li class="dropdown-item"><!----> <a href="/jq/JQuery/" class="nav-link">
  JQuery
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="node" class="dropdown-title"><span class="title">node</span> <span class="arrow down"></span></button> <button type="button" aria-label="node" class="mobile-dropdown-title"><span class="title">node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/Node入门及模块系统/" class="nav-link">
  入门
</a></li><li class="dropdown-item"><!----> <a href="/project/大事件/大事件-01/" class="nav-link">
  node大事件
</a></li><li class="dropdown-item"><!----> <a href="/node/NPM/" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/node/Express/" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/node/接口测试工具/" class="nav-link">
  接口测试工具
</a></li><li class="dropdown-item"><!----> <a href="/node/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/node/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/node/ES6/" class="nav-link">
  es6
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          vue基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/vue基础/笔记/" class="nav-link">
  vue基础
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/03-前端路由/" class="nav-link">
  前端路由
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/03-前后端对接/" class="nav-link">
  前后端交互
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/04-前端工程化/" class="nav-link">
  前端工程化
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/05-综合案例/" class="nav-link">
  综合案例
</a></li></ul></li><li class="dropdown-item"><h4>
          vue进阶目录
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/vue进阶/vue进阶/" class="nav-link">
  vue进阶
</a></li><li class="dropdown-subitem"><a href="/vue/vuex/outline-vuex/" class="nav-link">
  vuex
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue项目" class="dropdown-title"><span class="title">vue项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue项目" class="mobile-dropdown-title"><span class="title">vue项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          大事件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/大事件/大事件-01/" class="nav-link">
  node大事件
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/project/头条移动/01-头条-Mobile-项目初始化/" class="nav-link">
  头条移动
</a></li><li class="dropdown-item"><!----> <a href="/project/头条综合案例/01-头条-PC-项目初始化/" class="nav-link">
  头条pc综合案例
</a></li><li class="dropdown-item"><!----> <a href="/project/中台/01-HR-项目初始化/" class="nav-link">
  中台
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="问题" class="dropdown-title"><span class="title">问题</span> <span class="arrow down"></span></button> <button type="button" aria-label="问题" class="mobile-dropdown-title"><span class="title">问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/question/" class="nav-link">
  问题总结小册
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          html
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端基础/第一天html笔记/" class="nav-link">
  html-one
</a></li><li class="dropdown-subitem"><a href="/前端基础/第二天html总结/" class="nav-link">
  html-two
</a></li></ul></li><li class="dropdown-item"><h4>
          css
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端基础/css第一天/" class="nav-link">
  css-one
</a></li><li class="dropdown-subitem"><a href="/前端基础/css第二天/" class="nav-link">
  css-two
</a></li><li class="dropdown-subitem"><a href="/前端基础/css第三天/" class="nav-link">
  css-twree
</a></li><li class="dropdown-subitem"><a href="/前端基础/css第四天/" class="nav-link">
  css-four
</a></li><li class="dropdown-subitem"><a href="/前端基础/笔记-day07-前端基础CSS第五天/" class="nav-link">
  css-five
</a></li><li class="dropdown-subitem"><a href="/前端基础/笔记-day08-前端基础CSS第六天/" class="nav-link">
  css-six
</a></li><li class="dropdown-subitem"><a href="/前端基础/笔记-day09-前端基础CSS第七天/" class="nav-link">
  css-seven
</a></li><li class="dropdown-subitem"><a href="/前端基础/day10-HTML5&amp;CSS3提高/" class="nav-link">
  css html提高
</a></li><li class="dropdown-subitem"><a href="/前端基础/移动端/" class="nav-link">
  移动端
</a></li><li class="dropdown-subitem"><a href="/前端基础/day01/" class="nav-link">
  移动端布局
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/basis/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/js/senior/" class="nav-link">
  JavaScript高级
</a></li><li class="dropdown-item"><!----> <a href="/webapi/webapinew/" class="nav-link">
  webapi新
</a></li><li class="dropdown-item"><!----> <a href="/webapi/pk webapi/" class="nav-link">
  webapi
</a></li><li class="dropdown-item"><!----> <a href="/js/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/js/跨域防抖节流 Promise/" class="nav-link">
  跨域防抖节流
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="git&amp;ajax&amp;JQ" class="dropdown-title"><span class="title">git&amp;ajax&amp;JQ</span> <span class="arrow down"></span></button> <button type="button" aria-label="git&amp;ajax&amp;JQ" class="mobile-dropdown-title"><span class="title">git&amp;ajax&amp;JQ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/git/Git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/ajax/Ajax/" class="nav-link">
  ajax
</a></li><li class="dropdown-item"><!----> <a href="/jq/JQuery/" class="nav-link">
  JQuery
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="node" class="dropdown-title"><span class="title">node</span> <span class="arrow down"></span></button> <button type="button" aria-label="node" class="mobile-dropdown-title"><span class="title">node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/Node入门及模块系统/" class="nav-link">
  入门
</a></li><li class="dropdown-item"><!----> <a href="/project/大事件/大事件-01/" class="nav-link">
  node大事件
</a></li><li class="dropdown-item"><!----> <a href="/node/NPM/" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/node/Express/" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/node/接口测试工具/" class="nav-link">
  接口测试工具
</a></li><li class="dropdown-item"><!----> <a href="/node/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/node/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/node/ES6/" class="nav-link">
  es6
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          vue基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/vue基础/笔记/" class="nav-link">
  vue基础
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/03-前端路由/" class="nav-link">
  前端路由
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/03-前后端对接/" class="nav-link">
  前后端交互
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/04-前端工程化/" class="nav-link">
  前端工程化
</a></li><li class="dropdown-subitem"><a href="/vue/vue基础/05-综合案例/" class="nav-link">
  综合案例
</a></li></ul></li><li class="dropdown-item"><h4>
          vue进阶目录
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/vue进阶/vue进阶/" class="nav-link">
  vue进阶
</a></li><li class="dropdown-subitem"><a href="/vue/vuex/outline-vuex/" class="nav-link">
  vuex
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue项目" class="dropdown-title"><span class="title">vue项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue项目" class="mobile-dropdown-title"><span class="title">vue项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          大事件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/大事件/大事件-01/" class="nav-link">
  node大事件
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/project/头条移动/01-头条-Mobile-项目初始化/" class="nav-link">
  头条移动
</a></li><li class="dropdown-item"><!----> <a href="/project/头条综合案例/01-头条-PC-项目初始化/" class="nav-link">
  头条pc综合案例
</a></li><li class="dropdown-item"><!----> <a href="/project/中台/01-HR-项目初始化/" class="nav-link">
  中台
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="问题" class="dropdown-title"><span class="title">问题</span> <span class="arrow down"></span></button> <button type="button" aria-label="问题" class="mobile-dropdown-title"><span class="title">问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/question/" class="nav-link">
  问题总结小册
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue进阶-day01</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#发布订阅模式" class="sidebar-link">发布订阅模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#基本介绍" class="sidebar-link">基本介绍</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#订阅方法实现" class="sidebar-link">订阅方法实现</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#发布方法实现" class="sidebar-link">发布方法实现</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#发布方法参数处理" class="sidebar-link">发布方法参数处理</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#发布方法this问题" class="sidebar-link">发布方法this问题</a></li></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#数据响应式分析" class="sidebar-link">数据响应式分析</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#object-defineproperty" class="sidebar-link">Object.defineProperty</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#监听data属性值变化" class="sidebar-link">监听data属性值变化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#模仿vue构造函数" class="sidebar-link">模仿Vue构造函数</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#模板编译器" class="sidebar-link">模板编译器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#基本结构" class="sidebar-link">基本结构</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#编译所有节点" class="sidebar-link">编译所有节点</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#编译文本节点" class="sidebar-link">编译文本节点</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#编译元素节点" class="sidebar-link">编译元素节点</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#整体测试" class="sidebar-link">整体测试</a></li></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#回顾" class="sidebar-link">回顾</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#模板编译器-2" class="sidebar-link">模板编译器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#基本结构-2" class="sidebar-link">基本结构</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#编译所有节点-2" class="sidebar-link">编译所有节点</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#编译文本节点-2" class="sidebar-link">编译文本节点</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#编译元素节点-2" class="sidebar-link">编译元素节点</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#整体测试-2" class="sidebar-link">整体测试</a></li></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#组件库封装" class="sidebar-link">组件库封装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#初始化项目" class="sidebar-link">初始化项目</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#全局组件与局部组件" class="sidebar-link">全局组件与局部组件</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#封装基本nav组件" class="sidebar-link">封装基本Nav组件</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#组件的打包" class="sidebar-link">组件的打包</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#测试打包的组件" class="sidebar-link">测试打包的组件</a></li></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#正式组件封装-button" class="sidebar-link">正式组件封装-Button</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#按钮基本功能" class="sidebar-link">按钮基本功能</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#配置按钮主题" class="sidebar-link">配置按钮主题</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#配置按钮的size属性" class="sidebar-link">配置按钮的size属性</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#按钮的点击事件处理" class="sidebar-link">按钮的点击事件处理</a></li></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#正式封装组件-editor" class="sidebar-link">正式封装组件-Editor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#基本组件效果" class="sidebar-link">基本组件效果</a></li><li class="sidebar-sub-header"><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#完成v-model双向绑定" class="sidebar-link">完成v-model双向绑定</a></li></ul></li><li><a href="/vue/vue%E8%BF%9B%E9%98%B6/vue%E8%BF%9B%E9%98%B6.html#拓展" class="sidebar-link">拓展</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue进阶-day01"><a href="#vue进阶-day01" class="header-anchor">#</a> Vue进阶-day01</h1> <h2 id="发布订阅模式"><a href="#发布订阅模式" class="header-anchor">#</a> 发布订阅模式</h2> <h3 id="基本介绍"><a href="#基本介绍" class="header-anchor">#</a> 基本介绍</h3> <blockquote><ul><li>监听/注册一个自定义事件 bus.$on('事件类型',处理函数)</li> <li>发布事件 bus.$emit('事件类型',参数)</li></ul></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用构造函数进行封装</span>
<span class="token keyword">function</span> <span class="token function">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在构造函数中添加一个固定的属性，值是空对象</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$on</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$emit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">var</span> bus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 注册事件(订阅消息)</span>
<span class="token comment">// bus.on('click',fn1)</span>
<span class="token comment">// bus.on('mouseover',fn2)</span>
<span class="token comment">// bus.on('xxoo',fn3)</span>
<span class="token comment">// 把多个事件类型和事件处理函数进行保存</span>

<span class="token comment">// 触发事件(发布消息)</span>
<span class="token comment">// bus.$emit('click',1)</span>
<span class="token comment">// bus.$emit('mouseover',2)</span>
<span class="token comment">// bus.$emit('xxoo',3)</span>
<span class="token comment">// 把多个事件类型进行取出,并且执行事件处理函数</span>

</code></pre></div><h3 id="订阅方法实现"><a href="#订阅方法实现" class="header-anchor">#</a> 订阅方法实现</h3> <ul><li>本质：就是把事件函数添加到数组中</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 订阅方法</span>
<span class="token comment">/*
  listeners: {
    'my-event': [
      () =&gt; {console.log('my-event')},
      () =&gt; {console.log('my-event1')}
    ],
    'my-info': [
      () =&gt; {console.log('my-info')}
    ]
  }
*/</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$on</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// if (this.listeners[type]) {</span>
  <span class="token comment">//   // listeners中有type类型的事件</span>
  <span class="token comment">//   this.listeners[type].push(callback)</span>
  <span class="token comment">// } else {</span>
  <span class="token comment">//   // listeners中没有type类型的事件</span>
  <span class="token comment">//   // this.listeners[type] = []</span>
  <span class="token comment">//   // this.listeners[type].push(callback)</span>
  <span class="token comment">//   this.listeners[type] = [callback]</span>
  <span class="token comment">// }</span>
  <span class="token comment">// ===========================</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="发布方法实现"><a href="#发布方法实现" class="header-anchor">#</a> 发布方法实现</h3> <ul><li>本质：就是触发数组中的指定方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 发布方法：触发订阅的特定事件函数</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$emit</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取要执行的事件回调</span>
  <span class="token comment">// const callbacks = this.listeners[type]</span>
  <span class="token comment">// // 遍历并执行所有的回调</span>
  <span class="token comment">// if (callbacks) {</span>
  <span class="token comment">//   callbacks.forEach(callback =&gt; {</span>
  <span class="token comment">//     callback()</span>
  <span class="token comment">//   })</span>
  <span class="token comment">// }</span>
  <span class="token comment">// ====================================</span>
  <span class="token comment">// 简化写法</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用封装的发布订阅方法</span>
<span class="token keyword">var</span> eventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'my-event'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'my-event'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'my-event'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'my-event1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'my-info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'my-info'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'my-event'</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="发布方法参数处理"><a href="#发布方法参数处理" class="header-anchor">#</a> 发布方法参数处理</h3> <ul><li>基于剩余参数方式处理多个参数的传递问题</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$emit</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>rest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'my-info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 此时params是数组</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'my-info:'</span> <span class="token operator">+</span> params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> params<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> params<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'my-info'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="发布方法this问题"><a href="#发布方法this问题" class="header-anchor">#</a> 发布方法this问题</h3> <ul><li>事件函数不要使用箭头函数，保证this是合适的（EventEmitter构造函数的实例对象）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$emit</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>rest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// call的参数一 this 指的就是原型方法中的this</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// callback(rest)</span>
    <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> rest<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'my-info'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此时params是数组</span>
  <span class="token comment">// console.log(params)</span>
  <span class="token comment">// console.log('my-info:' + params[0] + params[1] + params[2])</span>
  <span class="token comment">// 这里的this是window(非严格模式)，严格模式下是undefined</span>
  <span class="token comment">// 函数中的this是谁由什么决定？调用者</span>
  <span class="token comment">// 如果是箭头函数，那么这里的this有父作用域决定</span>
  <span class="token comment">// 但是，我们希望这里的this是谁？EventEmitter构造函数的实例对象</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'my-info'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>完整版代码</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">EventEmitter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$on</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$emit</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>rest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> rest<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="数据响应式分析"><a href="#数据响应式分析" class="header-anchor">#</a> 数据响应式分析</h2> <blockquote><p>目标：熟悉数据的响应式模式（数据的变化会导致页面自动更新）</p> <p><a href="https://cn.vuejs.org/v2/guide/reactivity.html" target="_blank" rel="noopener noreferrer">Vue响应式官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li>Vue的MVVM的实现原理包含以下几部分</li></ul> <ol><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener noreferrer">Object.defineProperty()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>方法- &gt; 为属性设置set和get方法-&gt;在<strong>数据变化时</strong>更新视图</li> <li>js发布订阅模式: 在数据变化时-&gt;通知其他位置更新视图</li></ol> <blockquote><p>我们需要自己写原生js代码实现MVVM这种思想（数据的响应式）</p></blockquote> <h2 id="object-defineproperty"><a href="#object-defineproperty" class="header-anchor">#</a> Object.defineProperty</h2> <blockquote><p>作用: <code>Object.defineProperty()</code> 方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性， 并返回这个对象。</p></blockquote> <ul><li><p>说明 Object.defineProperty(obj, prop, descriptor)</p> <ul><li>形参1: 被操作的对象</li> <li>形参2: 新属性或者现有属性</li> <li>形参3: 属性描述符
<ul><li><strong>configurable</strong> 是否可以删除属性</li> <li><strong>enumerable</strong> 是否可以遍历属性</li> <li><strong>writable</strong> 是否可以进行赋值操作</li></ul></li> <li>返回值:返回被操作的对象</li></ul></li> <li><p>基本使用规则</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Object.defineProperty(obj, prop, descriptor)</span>
<span class="token comment">// 参数一表示原始对象</span>
<span class="token comment">// 参数二表示添加的新的属性名称</span>
<span class="token comment">// 参数三表示属性修饰符</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    msg<span class="token operator">:</span> <span class="token string">'hello'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 如下的代码向obj对象中添加了一个info属性，他的值是nihao</span>
<span class="token comment">// 默认修饰符值都是false (添加修饰符可以更好的控制属性的行为)</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token string">'nihao'</span><span class="token punctuation">,</span>
    <span class="token comment">// 是否可以删除属性(true表示允许删除；false表示不允许删除)</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 是否可以枚举（遍历）:true表示可以遍历，false表示不可以遍历</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 是否可以修改属性值:true表示可以修改，false表示不可以</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// obj.info = 'nihao'</span>
<span class="token comment">// delete obj1.info</span>
<span class="token comment">// console.log(obj1)</span>

<span class="token comment">// for (var key in obj1) {</span>
<span class="token comment">//   console.log(key)</span>
<span class="token comment">// }</span>

obj1<span class="token punctuation">.</span>info <span class="token operator">=</span> <span class="token string">'hi'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span>
</code></pre></div><ul><li>set和get用法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'lisi'</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> _age <span class="token operator">=</span> <span class="token number">11</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// value: 99,</span>
  <span class="token comment">// 当我们访问属性age时，自动触发get方法</span>
  <span class="token comment">// 当我们设置属性age时，自动触发set方法</span>
  <span class="token function">set</span> <span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _age <span class="token operator">=</span> age
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> _age
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// console.log(obj1)</span>
<span class="token comment">// console.log(obj1.age)</span>
obj1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">12</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>当访问对象的属性时,会调用属性的get方法,当为对象的属性设置值时,会调用属性的set方法</p> <p><strong>注意</strong>:value和get/set不能同时进行设置</p></blockquote> <h2 id="监听data属性值变化"><a href="#监听data属性值变化" class="header-anchor">#</a> 监听data属性值变化</h2> <blockquote><p>目标: 利用Object.defineProperty()模拟Vue中的Vue实例化对象的效果</p> <p>核心:把data的数据挂到vm对象上,直接访问vm.数据名字可以调用对应的set/get方法</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 监听数据的变化</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  msg<span class="token operator">:</span> <span class="token string">'hello'</span>
<span class="token punctuation">}</span>
<span class="token comment">// const vm = new Vue({</span>
<span class="token comment">//   el: '#app',</span>
<span class="token comment">//   data: data</span>
<span class="token comment">// })</span>
<span class="token comment">// console.log(vm.msg)</span>

<span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 返回数据</span>
    <span class="token keyword">return</span> data<span class="token punctuation">.</span>msg
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置数据</span>
    data<span class="token punctuation">.</span>msg <span class="token operator">=</span> v
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
vm<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'hi'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
</code></pre></div><h2 id="模仿vue构造函数"><a href="#模仿vue构造函数" class="header-anchor">#</a> 模仿Vue构造函数</h2> <ul><li>通过Vue的构造函数监听data中数据的变化</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 模仿Vue的构造函数实现一个功能</span>
<span class="token keyword">function</span> <span class="token function">Vue</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> el <span class="token operator">=</span> options<span class="token punctuation">.</span>el
  <span class="token comment">// 此处的$el是什么？DOM元素</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$el <span class="token operator">=</span> <span class="token keyword">typeof</span> el <span class="token operator">===</span> <span class="token string">'string'</span><span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token operator">:</span> el
  <span class="token comment">// $data是谁？其实就是构造函数参数中的data数据</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$data <span class="token operator">=</span> options<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 该构造函数核心功能之一：监听data中数据的变化</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">observer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 该方法负责监听数据的变化</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">observer</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Object.keys方法作用是获取对象的所有属性名称形成一个数组</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// key就是其中一个data对象中的属性</span>
    <span class="token comment">// 这里要监听每一个对象的属性</span>
    <span class="token comment">// 这里的this是Vue实例对象</span>
    <span class="token comment">// 把所有的data中的属性添加到vm（this）中</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      configurable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token function">set</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 给data中的属性赋值</span>
        data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> v
        <span class="token comment">// 处理模板的数据变化(把数据填充到标签中：数据绑定)</span>
        <span class="token comment">// 编译：把vue语法规则和数据转换成功HTML</span>
        <span class="token comment">// 乞丐版</span>
        <span class="token comment">// 通过[编译器]实现模板的自动更新 Compiler</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// el: document.querySelector('#app')</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    msg<span class="token operator">:</span> <span class="token string">'nihao'</span><span class="token punctuation">,</span>
    info<span class="token operator">:</span> <span class="token string">'hello'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

vm<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'hi'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>

</code></pre></div><blockquote><p>总结：通过vm操作data中的数据，使页面进行响应式改变（数据的响应式）</p> <p>基于Object.defineProperty方法的set和get特性实现数据劫持。</p></blockquote> <h2 id="模板编译器"><a href="#模板编译器" class="header-anchor">#</a> 模板编译器</h2> <h3 id="基本结构"><a href="#基本结构" class="header-anchor">#</a> 基本结构</h3> <ul><li>封装编译器构造函数并且添加基本的类型判断原型方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
  实现编译器功能
*/</span>

<span class="token keyword">function</span> <span class="token function">Compiler</span> <span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此处形参vm应该是谁？Vue构造函数的实例对象</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$vm <span class="token operator">=</span> vm
<span class="token punctuation">}</span>

<span class="token comment">// 判断文本节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">isTextNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 参数dom表示DOM节点元素，nodeType===3表示dom是文本节点</span>
  <span class="token keyword">return</span> dom<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">3</span>
<span class="token punctuation">}</span>

<span class="token comment">// 判断元素节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">isElementNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如下的dom.nodeType === 1 表示dom是元素节点</span>
  <span class="token keyword">return</span> dom<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token comment">// 判断属性是否为指令</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">isDirective</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">attr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 参数attr表示属性名称，类型是字符串</span>
  <span class="token comment">// startsWith方法是ES引入的字符串方法，用于判断是否以指定的字符串开始</span>
  <span class="token comment">// attr = v-text</span>
  <span class="token keyword">return</span> attr<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'v-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="编译所有节点"><a href="#编译所有节点" class="header-anchor">#</a> 编译所有节点</h3> <blockquote><p>目标：编译模板所有节点主体流程</p></blockquote> <ul><li>封装编译模板相关方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 封装一个模板编译方法</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compile</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此处vm表示Vue实例对象</span>
  <span class="token comment">// 通过vm获取模板中的所有DOM元素，分别判断是文本节点，还是元素节点，进而分别实现编译</span>
  <span class="token comment">// 通过vm.$el.children/childNodes获取DOM节点的所有子元素，然后遍历操作，分别处理即可</span>

  <span class="token comment">// 如果是文本节点，需要编译插值表达式 &lt;div&gt;{{msg}}&lt;/div&gt;</span>
  <span class="token comment">// this.compileTextNode(文本DOM节点) </span>

  <span class="token comment">// 如果是元素节点，需要编译元素的指令 &lt;p v-text='msg'&gt;&lt;/p&gt;</span>
  <span class="token comment">// this.compileElementNode(元素DOM节点)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 编译文本节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileTextNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment">// 编译元素节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileElementNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>
</code></pre></div><ul><li>具体实现编译流程代码</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 封装一个模板编译方法</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compile</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此处vm表示Vue实例对象</span>
  <span class="token comment">// 通过vm获取模板中的所有DOM元素，分别判断是文本节点，还是元素节点，进而分别实现编译</span>
  <span class="token comment">// 通过vm.$el.children/childNodes获取DOM节点的所有子元素，然后遍历操作，分别处理即可</span>
  <span class="token comment">// 把vm.$el.children伪数组转换为数组</span>
  <span class="token comment">// dom。children是不包括文本节点的，但是childNodes是包括文本节点的</span>
  <span class="token keyword">const</span> nodes <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span>
  nodes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里的item是谁？其中一个DOM节点</span>
    <span class="token comment">// 这里需要判断item这个元素是文本节点还是元素节点</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isTextNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果是文本节点，需要编译插值表达式 &lt;div&gt;{{msg}}&lt;/div&gt;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compileTextNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> 
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isElementNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果是元素节点，需要编译元素的指令 &lt;p v-text='msg'&gt;&lt;/p&gt;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compileElementNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token comment">// 递归调用实现子元素编译</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结：编译跟节点中的子元素（文本节点和元素节点）</p> <p>如果是元素节点，就进行递归编译</p></blockquote> <h3 id="编译文本节点"><a href="#编译文本节点" class="header-anchor">#</a> 编译文本节点</h3> <ul><li>初始化编译</li> <li>数据更新时的编译</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 编译文本节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileTextNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取文本节点的内容(文本节点使用textContent；元素节点可以使用innerText/innerHTML）</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> dom<span class="token punctuation">.</span>textContent
  <span class="token comment">// 判断文本节点是否为插值表达式</span>
  <span class="token comment">// 小括号表示分组（子串）： {{ msg }}</span>
  <span class="token comment">// .不包含回车换行符（\s\S处理换行问题）</span>
  <span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\{\{(.+)\}\}</span><span class="token regex-delimiter">/</span></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 把插值表达式替换为数据内容并且更新到DOM节点</span>
    <span class="token comment">// 现在我们要更新的内容从哪里来？this.$data</span>
    <span class="token comment">// 获取数据的 key=RegExp.$1.trim() = msg</span>
    <span class="token comment">// $1表示第一个子串的内容，trim方法的作用去掉key两边的空格</span>
    <span class="token keyword">const</span> key <span class="token operator">=</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 页面初始化时，渲染DOM的内容</span>
    dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token comment">// 订阅模板的响应式编译动作</span>
    eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 属性发生改变时，动态更新页面DOM的内容</span>
      dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="编译元素节点"><a href="#编译元素节点" class="header-anchor">#</a> 编译元素节点</h3> <ul><li>初始化编译</li> <li>数据更新时的编译</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 编译元素节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileElementNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取元素的所有属性</span>
  <span class="token keyword">const</span> attrs <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>attributes<span class="token punctuation">)</span>
  <span class="token comment">// 判断每一个属性是否为指令</span>
  attrs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">attr</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// attr表示其中一个属性的描述对象(Attr构造函数的实例对象)</span>
    <span class="token comment">// 获取属性名称和属性值</span>
    <span class="token comment">// &lt;div v-text='msg'&gt;&lt;/div&gt;</span>
    <span class="token comment">// 获取属性的名称</span>
    <span class="token keyword">const</span> keyName <span class="token operator">=</span> attr<span class="token punctuation">.</span>name   <span class="token comment">// v-text</span>
    <span class="token comment">// 获取属性的值</span>
    <span class="token keyword">const</span> keyValue <span class="token operator">=</span> attr<span class="token punctuation">.</span>value <span class="token comment">// msg</span>
    <span class="token comment">// 判断属性是否为指令</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isDirective</span><span class="token punctuation">(</span>keyName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 这个属性是指令</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>keyName <span class="token operator">===</span> <span class="token string">'v-text'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 证明该指令为v-text: 应该把指令绑定的属性名称对应的数据进行填充</span>
        <span class="token comment">// 页面初始化时，渲染DOM的内容</span>
        dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
        <span class="token comment">// 订阅模板的响应式编译动作</span>
        eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>keyValue<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// 属性发生改变时，动态更新页面DOM的内容</span>
          dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
        <span class="token comment">// 支持v-model指令</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>keyName <span class="token operator">===</span> <span class="token string">'v-model'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 需要把指令对应的值作为key获取data中的数据</span>
          <span class="token comment">// 然后赋值给input元素的value属性赋值</span>
          dom<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
          <span class="token comment">// 订阅模板的响应式编译动作</span>
          eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>keyValue<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 属性发生改变时，动态更新页面DOM的内容</span>
            dom<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">// 监听input输入域的input事件</span>
          dom<span class="token punctuation">.</span><span class="token function-variable function">oninput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 把输入的最新数据更新到vm中</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="整体测试"><a href="#整体测试" class="header-anchor">#</a> 整体测试</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{info}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>msg<span class="token punctuation">'</span></span> <span class="token attr-name">abc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>hello<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{uname}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>uname<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./eventbus.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./compilor.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./minivue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// el: document.querySelector('#app')</span>
      el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        msg<span class="token operator">:</span> <span class="token string">'nihao'</span><span class="token punctuation">,</span>
        info<span class="token operator">:</span> <span class="token string">'hello'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    vm<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'hi'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
    <span class="token comment">// console.log(vm)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>MVVM 总结
<ul><li>发布订阅模式代码实现  eventbus.js</li> <li>模仿Vue构造函数并进行数据监听 myvue.js</li> <li>Vue模板编译器 compiler.js</li></ul></li></ul> <p><img src="https://gitee.com/ye-xingchen/tuchuang/raw/master/img/image-20210204113353743.png" alt="image-20210204113353743"></p> <h1 id="vue进阶"><a href="#vue进阶" class="header-anchor">#</a> Vue进阶</h1> <h2 id="回顾"><a href="#回顾" class="header-anchor">#</a> 回顾</h2> <ul><li><p>发布订阅模式（把函数放到数组中并且给数组起名称）</p> <ul><li>构造函数  listeners</li> <li>订阅方法  $on</li> <li>发布方法  $emit</li></ul></li> <li><p>数据响应式相关知识点</p> <ul><li>Object.defineProperty(obj, attr, config) : 作用是给对象添加属性，或者配置属性的行为
<ul><li>控制属性是否可以删除</li> <li>控制属性是否可以枚举</li> <li>控制属性是否可以重新赋值</li> <li>value用于提供默认值，但是不可以和set/get同时出现</li> <li>属性的访问操作父 set 和 get
<ul><li>当通过obj访问属性时，自动触发get方法</li> <li>当通过obj设置属性时，自动触发set方法</li></ul></li></ul></li></ul></li> <li><p>模仿Vue的构造函数实现MiniVue</p> <ul><li><p>基本构造函数的结构</p> <ul><li>$el  表示跟DOM元素</li> <li>$data  表示所有的data中的数据</li></ul></li> <li><p>侦听函数observer，用于侦听data中的所有data中的属性</p></li> <li><p>编译器 Compilor ,用于将容器中的所有插值表达式和指令编译成浏览器认识的代码</p></li></ul></li></ul> <h2 id="模板编译器-2"><a href="#模板编译器-2" class="header-anchor">#</a> 模板编译器</h2> <h3 id="基本结构-2"><a href="#基本结构-2" class="header-anchor">#</a> 基本结构</h3> <ul><li>封装编译器构造函数并且添加基本的类型判断原型方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
  实现编译器功能
*/</span>

<span class="token keyword">function</span> <span class="token function">Compiler</span> <span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此处形参vm应该是谁？Vue构造函数的实例对象</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$vm <span class="token operator">=</span> vm
<span class="token punctuation">}</span>

<span class="token comment">// 判断文本节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">isTextNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 参数dom表示DOM节点元素，nodeType===3表示dom是文本节点</span>
  <span class="token keyword">return</span> dom<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">3</span>
<span class="token punctuation">}</span>

<span class="token comment">// 判断元素节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">isElementNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如下的dom.nodeType === 1 表示dom是元素节点</span>
  <span class="token keyword">return</span> dom<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token comment">// 判断属性是否为指令</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">isDirective</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">attr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 参数attr表示属性名称，类型是字符串</span>
  <span class="token comment">// startsWith方法是ES引入的字符串方法，用于判断是否以指定的字符串开始</span>
  <span class="token comment">// attr = v-text</span>
  <span class="token keyword">return</span> attr<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'v-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="编译所有节点-2"><a href="#编译所有节点-2" class="header-anchor">#</a> 编译所有节点</h3> <blockquote><p>目标：编译模板所有节点主体流程</p></blockquote> <ul><li>封装编译模板相关方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 封装一个模板编译方法</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compile</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此处vm表示Vue实例对象</span>
  <span class="token comment">// 通过vm获取模板中的所有DOM元素，分别判断是文本节点，还是元素节点，进而分别实现编译</span>
  <span class="token comment">// 通过vm.$el.children/childNodes获取DOM节点的所有子元素，然后遍历操作，分别处理即可</span>

  <span class="token comment">// 如果是文本节点，需要编译插值表达式 &lt;div&gt;{{msg}}&lt;/div&gt;</span>
  <span class="token comment">// this.compileTextNode(文本DOM节点) </span>

  <span class="token comment">// 如果是元素节点，需要编译元素的指令 &lt;p v-text='msg'&gt;&lt;/p&gt;</span>
  <span class="token comment">// this.compileElementNode(元素DOM节点)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 编译文本节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileTextNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment">// 编译元素节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileElementNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>
</code></pre></div><ul><li>具体实现编译流程代码</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 封装一个模板编译方法</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compile</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此处vm表示Vue实例对象</span>
  <span class="token comment">// 通过vm获取模板中的所有DOM元素，分别判断是文本节点，还是元素节点，进而分别实现编译</span>
  <span class="token comment">// 通过vm.$el.children/childNodes获取DOM节点的所有子元素，然后遍历操作，分别处理即可</span>
  <span class="token comment">// 把vm.$el.children伪数组转换为数组</span>
  <span class="token comment">// dom。children是不包括文本节点的，但是childNodes是包括文本节点的</span>
  <span class="token keyword">const</span> nodes <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span>
  nodes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里的item是谁？其中一个DOM节点</span>
    <span class="token comment">// 这里需要判断item这个元素是文本节点还是元素节点</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isTextNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果是文本节点，需要编译插值表达式 &lt;div&gt;{{msg}}&lt;/div&gt;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compileTextNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> 
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isElementNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果是元素节点，需要编译元素的指令 &lt;p v-text='msg'&gt;&lt;/p&gt;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compileElementNode</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token comment">// 递归调用实现子元素编译</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="编译文本节点-2"><a href="#编译文本节点-2" class="header-anchor">#</a> 编译文本节点</h3> <ul><li>初始化编译</li> <li>数据更新时的编译</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 编译文本节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileTextNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取文本节点的内容(文本节点使用textContent；元素节点可以使用innerText/innerHTML）</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> dom<span class="token punctuation">.</span>textContent
  <span class="token comment">// 判断文本节点是否为插值表达式</span>
  <span class="token comment">// 小括号表示分组（子串）： {{ msg }}</span>
  <span class="token comment">// .不包含回车换行符（\s\S处理换行问题）</span>
  <span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\{\{(.+)\}\}</span><span class="token regex-delimiter">/</span></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 把插值表达式替换为数据内容并且更新到DOM节点</span>
    <span class="token comment">// 现在我们要更新的内容从哪里来？this.$data</span>
    <span class="token comment">// 获取数据的 key=RegExp.$1.trim() = msg</span>
    <span class="token comment">// $1表示第一个子串的内容，trim方法的作用去掉key两边的空格</span>
    <span class="token keyword">const</span> key <span class="token operator">=</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 页面初始化时，渲染DOM的内容</span>
    dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token comment">// 订阅模板的响应式编译动作</span>
    eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 属性发生改变时，动态更新页面DOM的内容</span>
      dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="编译元素节点-2"><a href="#编译元素节点-2" class="header-anchor">#</a> 编译元素节点</h3> <ul><li>初始化编译</li> <li>数据更新时的编译</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 编译元素节点</span>
<span class="token class-name">Compiler</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">compileElementNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取元素的所有属性</span>
  <span class="token keyword">const</span> attrs <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dom<span class="token punctuation">.</span>attributes<span class="token punctuation">)</span>
  <span class="token comment">// 判断每一个属性是否为指令</span>
  attrs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">attr</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// attr表示其中一个属性的描述对象(Attr构造函数的实例对象)</span>
    <span class="token comment">// 获取属性名称和属性值</span>
    <span class="token comment">// &lt;div v-text='msg'&gt;&lt;/div&gt;</span>
    <span class="token comment">// 获取属性的名称</span>
    <span class="token keyword">const</span> keyName <span class="token operator">=</span> attr<span class="token punctuation">.</span>name   <span class="token comment">// v-text</span>
    <span class="token comment">// 获取属性的值</span>
    <span class="token keyword">const</span> keyValue <span class="token operator">=</span> attr<span class="token punctuation">.</span>value <span class="token comment">// msg</span>
    <span class="token comment">// 判断属性是否为指令</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isDirective</span><span class="token punctuation">(</span>keyName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 这个属性是指令</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>keyName <span class="token operator">===</span> <span class="token string">'v-text'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 证明该指令为v-text: 应该把指令绑定的属性名称对应的数据进行填充</span>
        <span class="token comment">// 页面初始化时，渲染DOM的内容</span>
        dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
        <span class="token comment">// 订阅模板的响应式编译动作</span>
        eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>keyValue<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// 属性发生改变时，动态更新页面DOM的内容</span>
          dom<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
        <span class="token comment">// 支持v-model指令</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>keyName <span class="token operator">===</span> <span class="token string">'v-model'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 需要把指令对应的值作为key获取data中的数据</span>
          <span class="token comment">// 然后赋值给input元素的value属性赋值</span>
          dom<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
          <span class="token comment">// 订阅模板的响应式编译动作</span>
          eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>keyValue<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 属性发生改变时，动态更新页面DOM的内容</span>
            dom<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">// 监听input输入域的input事件</span>
          dom<span class="token punctuation">.</span><span class="token function-variable function">oninput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 把输入的最新数据更新到vm中</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$vm<span class="token punctuation">[</span>keyValue<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结：编译指令：v-text;v-model</p> <p>核心，解析属性，根据属性值获取数据并进行更新，v-model需要额外监听内容变化的事件。</p></blockquote> <h3 id="整体测试-2"><a href="#整体测试-2" class="header-anchor">#</a> 整体测试</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{info}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>msg<span class="token punctuation">'</span></span> <span class="token attr-name">abc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>hello<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{uname}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>uname<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./eventbus.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./compiler.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./myvue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// el: document.querySelector('#app')</span>
      el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        msg<span class="token operator">:</span> <span class="token string">'nihao'</span><span class="token punctuation">,</span>
        info<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
        uname<span class="token operator">:</span> <span class="token string">'tom'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    vm<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'hi'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
    <span class="token comment">// console.log(vm)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>MVVM 总结
<ul><li>发布订阅模式代码实现  eventbus.js</li> <li>模仿Vue构造函数并进行数据监听 myvue.js</li> <li>Vue模板编译器 compiler.js</li></ul></li></ul> <p><img src="https://gitee.com/ye-xingchen/tuchuang/raw/master/img/image-2021020413353743.png" alt="image-20210204113353743"></p> <h2 id="组件库封装"><a href="#组件库封装" class="header-anchor">#</a> 组件库封装</h2> <blockquote><p>PC端项目：Element-UI</p> <p>移动端项目：Vant</p> <p>接下来我们要自己封装一个UI组件库</p></blockquote> <h3 id="初始化项目"><a href="#初始化项目" class="header-anchor">#</a> 初始化项目</h3> <blockquote><p>目标：实现组件库项目初始化</p></blockquote> <ul><li>创建项目 my-ui</li> <li>基于git进行管理
<ul><li>git init</li> <li>git add</li> <li>git commit</li> <li>git remote add origin master https://gitee.com/byte1031/my-ui.git</li> <li>git push -u origin master</li></ul></li></ul> <h3 id="全局组件与局部组件"><a href="#全局组件与局部组件" class="header-anchor">#</a> 全局组件与局部组件</h3> <blockquote><p>目标：回顾全局组件和局部组件的区别</p></blockquote> <ul><li>全局组件 <code>Vue.component(组件名称, 组件的配置选项)</code></li> <li>局部组件 <code>components: { 组件名称: 组件的配置选项}</code></li> <li>插件
<ul><li>先定义</li> <li>再导入并配置</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
  封装一个Vue插件
  Vue插件本质就是一个对象，但是对象里面必须有一个install函数
*/</span>
<span class="token keyword">import</span> MyButton <span class="token keyword">from</span> <span class="token string">'@/components/Button/index.vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 全局注册组件</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'byte-button'</span><span class="token punctuation">,</span> MyButton<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// -------------------------------------------------------</span>
<span class="token comment">// 导入并配置Vue插件</span>
<span class="token keyword">import</span> ByteUI <span class="token keyword">from</span> <span class="token string">'@/plugins.js'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ByteUI<span class="token punctuation">)</span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>// @/components/Button/index.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>总结：</p> <ol><li>全局组件如何定义</li> <li>局部组件如何定义</li> <li>Vue插件如何定义和使用</li></ol></blockquote> <h3 id="封装基本nav组件"><a href="#封装基本nav组件" class="header-anchor">#</a> 封装基本Nav组件</h3> <blockquote><p>目标：封装一个基本的Nav组件</p> <p>import Nav from '@/components/Nav/index.vue'</p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mynav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.mynav</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.mynav .item</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid pink<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'@/components/Button/index.vue'</span>
<span class="token keyword">import</span> Nav <span class="token keyword">from</span> <span class="token string">'@/components/Nav/index.vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 全局注册组件</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'byte-button'</span><span class="token punctuation">,</span> Button<span class="token punctuation">)</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'byte-nav'</span><span class="token punctuation">,</span> Nav<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结：先创建组件；然后配置插件的中全局组件；使用组件</p></blockquote> <h3 id="组件的打包"><a href="#组件的打包" class="header-anchor">#</a> 组件的打包</h3> <blockquote><p>目标：实现组件的基本打包效果</p> <p><a href="https://cli.vuejs.org/zh/guide/build-targets.html" target="_blank" rel="noopener noreferrer">打包为库<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li>基于vue脚手架命令实现UI组件库的打包
<ul><li>--target lib （表示打包为库）</li> <li>--dest 目标目录 （打包后输出的目录）</li> <li>--name 你的库名 （打包后的UI组件库的文件名称）</li> <li>入口地址（组件库的入口文件）</li></ul></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># vue-cli-service build --target lib --dest 目标目录 --name 你的库名 入口地址</span>
vue-cli-service build --target lib --dest dist --name myuilib ./src/components/index.js
</code></pre></div><h3 id="测试打包的组件"><a href="#测试打包的组件" class="header-anchor">#</a> 测试打包的组件</h3> <blockquote><p>目标：基于打包好的组件库实现组件效果</p></blockquote> <ul><li>导入打包好的文件进行测试</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> MyUI <span class="token keyword">from</span> <span class="token string">'../dist/myuilib.umd.min.js'</span>
<span class="token keyword">import</span> <span class="token string">'../dist/myuilib.css'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>MyUI<span class="token punctuation">)</span>
</code></pre></div><ul><li>临时获取eslint验证(不推荐)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在'../dist/myuilib.umd.min.js'文件的顶部添加 /* eslint-disable */</span>
</code></pre></div><ul><li>可以基于eslint配置文件设置忽略的验证  <code>.eslintignore</code> <ul><li><a href="https://eslint.org/docs/user-guide/configuring/ignoring-code#the-eslintignore-file" target="_blank" rel="noopener noreferrer">官方说明<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在项目的跟下面创建.eslintignore文件，文件内，添加忽略验证的文件目录或者文件名称</span>
</code></pre></div><ul><li>package.json文件中也支持通过属性的方式配置ellint验证的或略信息</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;eslintIgnore&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;hello.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world.js&quot;</span><span class="token punctuation">]</span> 
</code></pre></div><ul><li>如果是正式测试UI组件库，应该按照如下方式使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 假设我们这个包发布了，别人安装如下的方式使用</span>
<span class="token comment">// 1、安装包 npm i my-ui</span>
<span class="token comment">// 2、导入包 import MyUI from 'my-ui'</span>
<span class="token comment">// 3、导入样式 import 'my-ui/dist/myuilib.css'</span>
<span class="token comment">// 4、配置插件 Vue.use(MyUI)</span>
</code></pre></div><ul><li>如果要发布正式的包，package.json文件需要做如下调整</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 需要去掉 &quot;private&quot;: true 配置</span>
<span class="token comment">// 2. 修改入口文件的路径 &quot;main&quot;: &quot;./dist/myuilib.umd.min.js&quot;</span>
<span class="token comment">// 当我们导入一个npm包的时候，默认导入的是哪个文件？package.json文件中的main属性指向的文件</span>
</code></pre></div><ul><li>发布包的后续流程参考Node.js课程阶段的npm包的发布过程</li></ul> <blockquote><p>总结：</p> <ol><li><p>导入打包后的压缩文件，但是要配置eslint忽略验证</p></li> <li><p>正式的发布包的流程参考Node.js阶段课程</p></li> <li><p>使用正式包的流程</p></li></ol></blockquote> <h2 id="正式组件封装-button"><a href="#正式组件封装-button" class="header-anchor">#</a> 正式组件封装-Button</h2> <h3 id="按钮基本功能"><a href="#按钮基本功能" class="header-anchor">#</a> 按钮基本功能</h3> <blockquote><p>目标：实现一个相对完美的组件</p> <p>组件文件：<code>components/Button/index.vue</code></p></blockquote> <ul><li>基于插槽实现按钮组件的内容定制</li></ul> <div class="language-less extra-class"><pre class="language-less"><code>&lt;template&gt;
  &lt;button class=<span class="token string">&quot;my-btn&quot;</span>&gt;
    &lt;slot&gt;点击&lt;<span class="token operator">/</span>slot&gt;
  &lt;<span class="token operator">/</span>button&gt;
&lt;<span class="token operator">/</span>template&gt;
&lt;style scoped&gt;
    <span class="token comment">// 默认背景色 默认大小</span>
    <span class="token selector">.my-btn</span> <span class="token punctuation">{</span>
      <span class="token property">line-height</span><span class="token punctuation">:</span> 1.499<span class="token punctuation">;</span>
      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
      <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token operator">-</span>block<span class="token punctuation">;</span>
      <span class="token property">font-weight</span><span class="token punctuation">:</span> 400<span class="token punctuation">;</span>
      <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">background-image</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 2px 0 <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.015<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
      <span class="token property">transition</span><span class="token punctuation">:</span> all 0.3s <span class="token function">cubic-bezier</span><span class="token punctuation">(</span>0.645<span class="token punctuation">,</span> 0.045<span class="token punctuation">,</span> 0.355<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">-webkit-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">-moz-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">-ms-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">touch-action</span><span class="token punctuation">:</span> manipulation<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 5px 10px<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.65<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #d9d9d9<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.my-btn:focus</span> <span class="token punctuation">{</span>
      <span class="token property">outline</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
&lt;<span class="token operator">/</span>style&gt;
</code></pre></div><blockquote><p>总结：基于插槽定制按钮的文本</p> <ol><li>普通插槽</li> <li>具名插槽</li> <li>作用域插槽</li></ol></blockquote> <h3 id="配置按钮主题"><a href="#配置按钮主题" class="header-anchor">#</a> 配置按钮主题</h3> <blockquote><p>目标：抽取按钮的type属性用于定制按钮的样式</p> <p>通过组件的props获取父组件注入的type属性</p></blockquote> <ul><li>样式主图类名</li></ul> <div class="language-less extra-class"><pre class="language-less"><code><span class="token selector">&lt;style scoped&gt;
button:focus</span> <span class="token punctuation">{</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.my-btn-default</span> <span class="token punctuation">{</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 1.499<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token operator">-</span>block<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 400<span class="token punctuation">;</span>
  <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 2px 0 <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.015<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> all 0.3s <span class="token function">cubic-bezier</span><span class="token punctuation">(</span>0.645<span class="token punctuation">,</span> 0.045<span class="token punctuation">,</span> 0.355<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">-webkit-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">-moz-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">-ms-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">touch-action</span><span class="token punctuation">:</span> manipulation<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 5px 10px<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.65<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #d9d9d9<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.my-btn-primary</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #1890ff<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> #1890ff<span class="token punctuation">;</span>
  <span class="token property">text-shadow</span><span class="token punctuation">:</span> 0 <span class="token operator">-</span>1px 0 <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.12<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 2px 0 <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.045<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.my-btn-danger</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #ff4d4f<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> #ff4d4f<span class="token punctuation">;</span>
  <span class="token property">text-shadow</span><span class="token punctuation">:</span> 0 <span class="token operator">-</span>1px 0 <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.12<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 2px 0 <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.045<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
&lt;<span class="token operator">/</span>style&gt;
</code></pre></div><ul><li>配置组件props属性</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>根据props的type类型动态计算类名</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-btn-default<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>typeClass<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 如果使用组件时，传递插槽了，就以传递的为准，否则默认显示【点击】 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'MyButtonTest'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 组件属性的类型检测</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'default'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">typeClass</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my-btn-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>总结：从使用的角度，通过什么影响组件的表现？传入组件的属性。组件属性的名称和值自定义（根据需求来确定）</p></blockquote> <h3 id="配置按钮的size属性"><a href="#配置按钮的size属性" class="header-anchor">#</a> 配置按钮的size属性</h3> <blockquote><p>目标：通过配置组件的size属性修改按钮的尺寸</p></blockquote> <ul><li>准备对应class类</li></ul> <div class="language-less extra-class"><pre class="language-less"><code><span class="token selector">&lt;style scoped&gt;
.my-btn-small</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 4px 8px<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.my-btn-large</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 6px 12px<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
&lt;<span class="token operator">/</span>style&gt;
</code></pre></div><ul><li>编写props</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 组件属性的类型检测</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'default'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    size<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// value形参表示父组件传递过来的值</span>
        <span class="token comment">// type的值只能是small或者large</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'small'</span><span class="token punctuation">,</span> <span class="token string">'large'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>功能实现</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'ByteButton'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    size<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'default'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自定义属性的验证规则</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'large'</span><span class="token punctuation">,</span> <span class="token string">'small'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">typeClass</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 根据组件传递type值决定样式类名</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my-btn-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">sizeClass</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my-btn-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-btn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>[typeClass, sizeClass]<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>总结：类型检测支持默认值，支持自定义验证规则</p></blockquote> <h3 id="按钮的点击事件处理"><a href="#按钮的点击事件处理" class="header-anchor">#</a> 按钮的点击事件处理</h3> <blockquote><p>目标：实现按钮的点击事件处理</p></blockquote> <ul><li>组件直接绑定click事件</li></ul> <blockquote><p>组件绑定的事件默认是不会被浏览器识别的，我们需要做额外的处理让事件生效，有俩种方案</p> <ol><li>添加<code>.native</code>修饰符，事件会被绑定到组件的根元素身上</li> <li>把click当成自定义事件通过<code>$emit</code>执行（推荐）</li></ol></blockquote> <ul><li>通过自定义事件触发事件</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>$emit(<span class="token punctuation">&quot;</span>btn-click<span class="token punctuation">&quot;</span>, $event)<span class="token punctuation">'</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-btn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>[typeClass, sizeClass]<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>byte-button</span> <span class="token attr-name">@btn-click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>handleClick<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>primary<span class="token punctuation">'</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>small<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>byte-button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>总结：</p> <ol><li><p>自定义组件标签上的原始事件绑定本质上不是原生事件，而是自定义事件，这种事件需要在子组件通过$emit触发</p></li> <li><p>如果希望在自定义组件标签上绑定原生事件，需要使用.native事件修饰符</p></li></ol></blockquote> <h2 id="正式封装组件-editor"><a href="#正式封装组件-editor" class="header-anchor">#</a> 正式封装组件-Editor</h2> <ul><li>目标：封装一个富文本编辑器组件</li></ul> <h3 id="基本组件效果"><a href="#基本组件效果" class="header-anchor">#</a> 基本组件效果</h3> <blockquote><p>目标：初步实现富文本编辑器效果</p> <p>组件文件路径：<code>components/Editor/index.vue</code></p></blockquote> <ul><li>基本组件效果
<ul><li>安装依赖包 npm i wangeditor</li> <li>导入包</li> <li>调用api初始化富文本</li></ul></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myeditor<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>editor<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token constant">E</span> <span class="token keyword">from</span> <span class="token string">'wangeditor'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'MyEditor'</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">initEditor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 初始化富文本</span>
      <span class="token comment">// const editor = new E('#myeditor')</span>
      <span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>editor
      <span class="token keyword">const</span> editor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">E</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span>
      editor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initEditor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>测试组件</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>home<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>我的UI组件库<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>byte-editor</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>byte-editor</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>总结：富文本用法（安装；导入；配置）</p></blockquote> <h3 id="完成v-model双向绑定"><a href="#完成v-model双向绑定" class="header-anchor">#</a> 完成v-model双向绑定</h3> <blockquote><p>目标：实现组件的双向数据绑定</p> <p>当我们在一个组件身上通过v-model绑定一个响应式数据时，记住，他是一个语法糖，实际上相当于完成了俩件事情：</p> <ol><li>组件上绑定了一个名为<code>value</code> 的自定义属性</li> <li>组件身上绑定了一个名为<code>input</code>的自定义事件</li></ol></blockquote> <ul><li>接收传入的数据</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myeditor<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>editor<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token constant">E</span> <span class="token keyword">from</span> <span class="token string">'wangeditor'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'MyEditor'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">initEditor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 初始化富文本</span>
      <span class="token comment">// const editor = new E('#myeditor')</span>
      <span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>editor
      <span class="token keyword">const</span> editor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">E</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span>
      editor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// 给富文本设置默认值</span>
      editor<span class="token punctuation">.</span>txt<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initEditor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><ul><li>测试数据传入操作</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>home<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>我的UI组件库<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-button</span>
      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>handleClick<span class="token punctuation">'</span></span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>danger<span class="token punctuation">'</span></span>
      <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>large<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
      提交
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-editor</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>editorValue<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-editor</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- &lt;my-editor :value='editorValue' @input='editorValue=$event'&gt;&lt;/my-editor&gt; --&gt;</span>
    <span class="token comment">&lt;!-- v-model的本质是是属性value绑定和事件input监听的语法糖 --&gt;</span>
    <span class="token comment">&lt;!-- $event表示子组件传递过来的参数值 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// import VanButton from '路径'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      editorValue<span class="token operator">:</span> <span class="token string">'hello'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleClick</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log('click')</span>
      <span class="token comment">// 点击之后，获取富文本的值</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>editorValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><ul><li>实现数据回传</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>methods<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">initEditor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 初始化富文本</span>
    <span class="token comment">// const editor = new E('#myeditor')</span>
    <span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>editor
    <span class="token keyword">const</span> editor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">E</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span>
    editor<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">newHtml</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 监听富文本中内容的变化: 参数表示富文本最新的内容</span>
      <span class="token comment">// 富文本内容有变化时，把内容传递回父组件</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> newHtml<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    editor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 给富文本设置默认值</span>
    editor<span class="token punctuation">.</span>txt<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><blockquote><p>总结：</p> <ol><li>v-model的本质是value属性绑定和input事件绑定的组合</li> <li>通过value初始化富文本</li> <li>通过input事件获取最新的富文本的值</li></ol></blockquote> <hr> <h2 id="拓展"><a href="#拓展" class="header-anchor">#</a> 拓展</h2> <blockquote><ol><li>单线程</li> <li>事件队列</li> <li>微任务：单独有一个微任务队列（执行时机：主线程结束后，宏任务执行之前）</li> <li>宏任务：进入事件队列的任务</li> <li>Promise</li> <li>Async函数</li></ol></blockquote> <ul><li>js的运行是单线程的（一个时间点只能做一件事情）</li> <li>单线程可能会阻塞浏览器</li> <li>所有通过事件队列改善这个问题：单线程 + 事件队列</li> <li>什么样的任务进入事件队列？
<ul><li>定时回调函数（满足延时时间）</li> <li>事件函数（事件被触发）</li> <li>Ajax的回调函数（后端有数据返回）</li></ul></li> <li>进入队列的任务何时执行？
<ul><li>主线程空闲</li> <li>满足特定的触发条件</li></ul></li></ul> <p><img src="https://gitee.com/ye-xingchen/tuchuang/raw/master/img/image-20210329164921001.png" alt="image-20210329164921001"></p> <ul><li>什么任务是微任务？Promise/Object.observe/ObserverMutation</li> <li>进入队列的任务依然可以产生新的宏任务或者微任务</li> <li>await后的任务执行到之后才会放入微任务队列</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://gitee.com/ye-xingchen/tuchuang/raw/master/img/image-20210329171537386.png" alt="image-20210329171537386"></p> <p><img src="imgs/image-20210329171927611.png" alt="image-20210329171927611"></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0d7c1303.js" defer></script><script src="/assets/js/2.1fe0b50b.js" defer></script><script src="/assets/js/70.5ff6d4e4.js" defer></script>
  </body>
</html>
